---
title: "558_Project1_Hunter"
author: "Samantha Hunter"
date: "9/24/2021"
output: html_document
---

```{r}
library(httr)
library(jsonlite)
library(purrr)
library(dplyr)
library(tibble)
library(purrr)
```

# Endpoint 1 - Ability - Done with query
```{r}
# Endpoint 1
#Here is an entire list of pokemon ability names
avail_ability <- GET("https://pokeapi.co/api/v2/ability/?limit=327&offset=0")
avail_ability <- rawToChar(avail_ability$content)
avail_ability <- fromJSON(avail_ability)
avail_ability <- avail_ability[["results"]][["name"]]
avail_ability

ability <- function(name, ...){
  url_ability <- paste0("https://pokeapi.co/api/v2/ability/", c(name, ...))
  poke_bility <- lapply(url_ability, GET)
  poke_bility<-lapply(poke_bility, '[[', 'content')
  poke_bility <- lapply(poke_bility, rawToChar)
  poke_bility <- lapply(poke_bility, fromJSON)
  return(poke_bility)
}

# THIS WORKS :)
stench <- ability("stench", "drizzle")

ability <- map(poke_bility, "name")
pokemon_ability <- map(map(map(poke_bility, "pokemon"), "pokemon"), "name")
generation <- map(map(poke_bility, "generation"), "name")
#battle_effect <- map(map(poke_bility, "effect_entries"), "effect")
#poke_bility[[1]][["effect_changes"]][["effect_entries"]][[1]][["effect"]][[2]]

```


# Endpoint 2 - Pokemon Type _ Done with Query
```{r}
# Endpoint 3 - there are 20 possible types 
avail_types <- GET("https://pokeapi.co/api/v2/type/?limit=20&offset=0")
avail_types <- rawToChar(avail_types$content)
avail_types <- fromJSON(avail_types)
avail_types <- avail_types[["results"]][["name"]]

url_type <- paste0("https://pokeapi.co/api/v2/type/", c(avail_types))
poke_type <- lapply(url_type, GET)
poke_type <-lapply(poke_type, '[[', 'content')
poke_type <- lapply(poke_type, rawToChar)
poke_type <- lapply(poke_type, fromJSON)

type <- map(poke_type, "name")
pokemon_type <- map(map(map(poke_type, "pokemon"), "pokemon"), "name")
double_from <- map(map(map(poke_type, "damage_relations"), "double_damage_from"), "name")
half_from <- map(map(map(poke_type, "damage_relations"), "half_damage_from"), "name")
no_from <- map(map(map(poke_type, "damage_relations"), "no_damage_from"), "name")
double_to <- map(map(map(poke_type, "damage_relations"), "double_damage_to"), "name")
half_to <- map(map(map(poke_type, "damage_relations"), "half_damage_to"), "name")
no_to <- map(map(map(poke_type, "damage_relations"), "no_damage_to"), "name")
```

# Endpoint 3 - Region
```{r}
# Pokemon Region - there are 8 of them
avail_region <- GET("https://pokeapi.co/api/v2/region/?limit=20&offset=0")
avail_region <- rawToChar(avail_region$content)
avail_region <- fromJSON(avail_region)
avail_region <- avail_region[["results"]][["name"]]

url_region <- paste0("https://pokeapi.co/api/v2/region/", c(avail_region))
poke_region <- lapply(url_region, GET)
poke_region <- lapply(poke_region, '[[', 'content')
poke_region <- lapply(poke_region, rawToChar)
poke_region <- lapply(poke_region, fromJSON)
```


# Endpoint 4 - Habitat
```{r}
# Endpoint2 - Pokemon Habitat, if you want all 9 habitats, please put
# 1:9
avail_habitat <- GET("https://pokeapi.co/api/v2/pokemon-habitat/?limit=20&offset=0")
avail_habitat <- rawToChar(avail_habitat$content)
avail_habitat <- fromJSON(avail_habitat)
avail_habitat <- avail_habitat[["results"]][["name"]]

url_habitat <- paste0("https://pokeapi.co/api/v2/pokemon-habitat/", c(avail_habitat))
poke_habitat <- lapply(url_habitat, GET)
poke_habitat <-lapply(poke_habitat, '[[', 'content')
poke_habitat <- lapply(poke_habitat, rawToChar)
poke_habitat <- lapply(poke_habitat, fromJSON)

habitat <- map(poke_habitat, "name")
pokemon_habitat <- map(map(poke_habitat, "pokemon_species"), "name")
```




# Endpoint 5 - Berries
```{r}
# There are 64 Berry Types
avail_berry <- GET("https://pokeapi.co/api/v2/berry?offset=0&limit=200")
avail_berry <- rawToChar(avail_berry$content)
avail_berry <- fromJSON(avail_berry)
avail_berry <- avail_berry[["results"]][["name"]]

url_berry <- paste0("https://pokeapi.co/api/v2/berry/", c(avail_berry))
poke_berry <- lapply(url_berry, GET)
poke_berry <- lapply(poke_berry, '[[', 'content')
poke_berry <- lapply(poke_berry, rawToChar)
poke_berry <- lapply(poke_berry, fromJSON)

berries <- as.vector(map(poke_berry, "name"))
growth_time <- as.vector(map(poke_berry, "growth_time"))
max_harvest <- as.vector(map(poke_berry, "max_harvest"))

```


# Endpoint 6 - Pokemon Base Stats (from Pokemon)
```{r}
# this produces duplicates of the same pokemon, there are 1188 available pokemon
# include in the function a way to supply the pokemon name, then make it correspond to 
# the indexing number
avail_pokemon <- GET("https://pokeapi.co/api/v2/pokemon/?limit=1200&offset=0")
avail_pokemon <- rawToChar(avail_pokemon$content)
avail_pokemon <- fromJSON(avail_pokemon)
avail_pokemon <- avail_pokemon[["results"]][["name"]]

url <- paste0("https://pokeapi.co/api/v2/pokemon/",c(avail_pokemon))
pokedex <- lapply(X = url, FUN = GET)
pokedex<-lapply(pokedex, '[[', 'content')
pokedex <- lapply(pokedex, rawToChar)
pokedex <- lapply(pokedex, fromJSON)

pokemon <- map(pokedex, "name")
base_stat <- map(map(pokedex, "stats"), "base_stat")

length(pokemon)
base_stat[[1]][1]

hp <- rep(0, 5)
attack <- rep(0, 5)
defense <- rep(0, 5)
sp_attack <- rep(0, 5)
sp_defense <- rep(0, 5)
speed <- rep(0, 5)

for(p in 5){
  hp <- base_stat[[p]][1]
  attack  <- base_stat[[p]][2]
  defense <- base_stat[[p]][3]
  sp_attack <- base_stat[[p]][4]
  sp_defense <- base_stat[[p]][5]
  speed <- base_stat[[p]][6]
}

```


```{r}

```











